/*! smart_player 2013-06-25 */
var Player={init:function(){},_state:"stop",play:function(a){this.stop(),this._state="play",this._play(a)},_play:function(){this.trigger("ready")},stop:function(a){"stop"!=this._state&&(this._stop(),a||this.trigger("stop")),this._state="stop"},_stop:function(){},videoInfo:{},autoInit:!0};!function(){var a,b;window._&&_.extend?a=_.extend:window.$&&$.extend&&(a=$.extend),window.EventEmitter?b=EventEmitter.prototype:window.Backbone?b=Backbone.Events:window.Events&&(b=Events.prototype),Player.extend=function(b){a(this,b)},Player.extend(b),Player.autoInit&&$(function(){$("body").on("load",function(){Player.init()})})}(),Player.extend({init:function(){var a=this;this.$video_container=$('<video id="smart_player" style="position: absolute; left: 0; top: 0;"></video>');var b=this.$video_container[0];$("body").append(this.$video_container),this.$video_container.on("loadedmetadata",function(){a.videoInfo.width=b.videoWidth,a.videoInfo.height=b.videoHeight,a.videoInfo.duration=b.duration,a.trigger("ready")}),this.$video_container.on("loadstart",function(){a.trigger("bufferingBegin")}).on("playing",function(){a.trigger("bufferingEnd")}).on("timeupdate",function(){a.videoInfo.currentTime=b.currentTime,a.trigger("update")}).on("ended",function(){a.trigger("complete")}),this.$video_container.on("abort canplay canplaythrough canplaythrough durationchange emptied ended error loadeddata loadedmetadata loadstart mozaudioavailable pause play playing ratechange seeked seeking suspend volumechange waiting",function(){})},_play:function(a){this.$video_container.attr("src",a.url),this.$video_container[0].play()},_stop:function(){this.$video_container[0].pause(),this.$video_container[0].src=""},seek:function(a){this.$video_container[0].currentTime=a},audio:{set:function(){},get:function(){},cur:function(){}}}),-1!=navigator.userAgent.toLowerCase().indexOf("maple")&&function(){var a=0,b=function(a,b,c){try{switch(c.length){case 0:return a[b]();case 1:return a[b](c[0]);case 2:return a[b](c[0],c[1]);case 3:return a[b](c[0],c[1],c[2]);case 4:return a[b](c[0],c[1],c[2],c[3]);case 5:return a[b](c[0],c[1],c[2],c[3],c[4]);case 6:return a[b](c[0],c[1],c[2],c[3],c[4],c[5]);case 7:return a[b](c[0],c[1],c[2],c[3],c[4],c[5],c[6]);case 8:return a[b](c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7])}}catch(d){throw d}};Player.extend({usePlayerObject:!1,init:function(){var a=this;if(a.usePlayerObject?(a.plugin=document.getElementById("pluginPlayer"),$("body").append(a.$plugin)):a.plugin=sf.core.sefplugin("Player"),!a.plugin)throw new Error("failed to set plugin");a.plugin.OnStreamInfoReady="Player.OnStreamInfoReady",a.plugin.OnRenderingComplete="Player.OnRenderingComplete",a.plugin.OnCurrentPlayTime="Player.OnCurrentPlayTime",a.plugin.OnCurrentPlaybackTime="Player.OnCurrentPlayTime",a.plugin.OnBufferingStart="Player.OnBufferingStart",a.plugin.OnBufferingComplete="Player.OnBufferingComplete",a.plugin.OnEvent="Player.onEvent"},seek:function(a){0>=a&&(a=0);var b=Math.floor(a-this.videoInfo.currentTime-1);this.videoInfo.currentTime=a,alert("jump: "+b),0>b?this.doPlugin("JumpBackward",-b):this.doPlugin("JumpForward",b)},onEvent:function(a,b){switch(a){case 9:this.OnStreamInfoReady();break;case 4:break;case 8:this.OnRenderingComplete();break;case 14:this.OnCurrentPlayTime(b);break;case 13:break;case 12:this.OnBufferingComplete();break;case 11:this.OnBufferingStart()}},OnRenderingComplete:function(){alert("PLAYER COMPLETE"),Player.trigger("complete")},OnStreamInfoReady:function(){var a,b,c,d;try{a=this.doPlugin("GetDuration")}catch(e){alert("######## "+e.message)}if(a=Math.ceil(a/1e3),this.usePlayerObject)b=this.doPlugin("GetVideoWidth"),c=this.doPlugin("GetVideoHeight");else if(d=this.doPlugin("GetVideoResolution"),-1==d)b=0,c=0;else{var f=d.split("|");b=f[0],c=f[1]}this.videoInfo.duration=a,this.videoInfo.width=1*b,this.videoInfo.height=1*c,this.trigger("ready")},OnBufferingStart:function(){this.trigger("bufferingBegin")},OnBufferingComplete:function(){this.trigger("bufferingEnd")},OnCurrentPlayTime:function(a){"play"==this._state&&(alert(a/1e3),this.videoInfo.currentTime=a/1e3,this.trigger("update"))},_play:function(a){var b=a.url;switch(a.type){case"hls":b+="|COMPONENT=HLS"}this.doPlugin("InitPlayer",b),this.doPlugin("StartPlayback",a.from||0)},_stop:function(){this.doPlugin("Stop")},doPlugin:function(){var a,c=this.plugin,d=arguments[0],e=Array.prototype.slice.call(arguments,1,arguments.length)||[];return this.usePlayerObject?a=b(c,d,e):(-1!=d.indexOf("Buffer")&&(d+="Size"),e.unshift(d),a=b(c,"Execute",e)),a},audio:{set:function(b){Player.doPlugin("SetStreamID",1,b),a=b},get:function(){for(var a=Player.doPlugin("GetTotalNumOfStreamID",1),b=[],c=0;a>c;c++)b.push(Player.doPlugin("GetStreamLanguageInfo",1,c));return b},cur:function(){return a}}})}();